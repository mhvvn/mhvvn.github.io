<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p>Pada case kali kita akan menerapkan dan konfigurasi webserver menggunakan Nodejs dan Nginx sebagai Revespoxy agar dapat mengarahkan trafik yang masuk ke Nodejs melalui Nginx terlebih dahulu</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/517/0*rowl3U6dQHq9k5WD.png"><figcaption><a href="https://allcode.com/aws-beginner-guide/" rel="external nofollow noopener" target="_blank">https://allcode.com/aws-beginner-guide/</a></figcaption></figure> <p>Sebelumnya untuk os menggunakan Ubuntu 20 yg busa di running pada virtual mechine apapun ataupun komputer lokal serta cloud server, di sini saya menggunakan Cloud server AWS dan os Ubuntu 20.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*kpbEiHTkQHKaG-pT.png"><figcaption><a href="https://ubuntu.com/" rel="external nofollow noopener" target="_blank">https://ubuntu.com/</a></figcaption></figure> <p>Untuk lebih mudah memilih versi Node.js pada EC2 instance, bisa gunakan tools NVM untuk membantu memudahakn versi mana yang ingin di gunakan, bisa menggunakan script berikut :</p> <figure><img alt="NVM, the Easiest Way to Switch Node.js Environments on Your Machine in a Flash | by Paige Niedringhaus | ITNEXT" src="https://cdn-images-1.medium.com/proxy/1*0HGTGpb0bdSo_xdlptb4-A.png"><figcaption><a href="https://github.com/nvm-sh/nvm" rel="external nofollow noopener" target="_blank">https://github.com/nvm-sh/nvm</a></figcaption></figure> <blockquote> <em>curl -o- </em><a href="https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh" rel="external nofollow noopener" target="_blank"><em>https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh</em></a><em> | bash</em> </blockquote> <p>Tunggu hingga selesai terinstall</p> <p>Selanjutnya, pasang Node.js versi v14.15.4 dengan perintah beriku</p> <blockquote>nvm install v14.15.4</blockquote> <p>Instal beberapa dependencies yang dibutuhkan oleh web server Node.js dengan menjalankan perintah ini:</p> <blockquote>npm install</blockquote> <p>jalankan web server dengan perintah berikut:</p> <blockquote>npm run start</blockquote> <p>Oke sekarang webser NodeJs telah selesai di install, untuk memastikan buka web browser dengan alamt ip publik server dengan port 8000, jika belum dapat di akses buka terlebih dahulu akses port 8000 pada scurity group AWS</p> <p>jika sudah di aktifkan, restart kembali node js dan reload lagi di browser.</p> <p>selanjutnya kofigurasi Reverproxy…</p> <h3>Konfigurasi Reverse Proxy Server on NGINX</h3> <figure><img alt="" src="https://cdn-images-1.medium.com/max/800/0*DVfT9Gfqx1MJiMeZ.png"><figcaption><a href="https://www.nginx.com/" rel="external nofollow noopener" target="_blank">https://www.nginx.com/</a></figcaption></figure> <p>Untuk memasang Nginx pada server (EC2) AWS</p> <p>pertama install nginx terlebih dahulu dengan printah berikut</p> <blockquote>sudo apt-get install nginx -y</blockquote> <p>setelah itu lihat status intallasi untuk memastikan nginx berjalan dengan printah ini</p> <blockquote>sudo systemctl status nginx</blockquote> <p>akan tetapi Nginx secara default berjalan pada port 80, sehingga kita perlu memberi akses atau membuka port 80 pada scurity group AWS, dengan menambahkan inbound rules baru pada intance yang di buat sebelumnya.</p> <p>jika sudah di aktifkan, pastikan sudah berjalan dengan baik yakni salin ip publik instance ke browser dan akan terlihat tampilan awa nginx seperti di bawah ini.</p> <p>sekarang kita telah berhasil menginstall nginx pada server selanjutnya adalah melakukan konfigurasi agar nginx dapat menampilkan webserver node js yang telah di siap sebelumnya sebagai tujuan utama.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*gvn5IxaOqwqc8mpL.png"><figcaption><a href="https://medium.com/globant/understanding-nginx-as-a-reverse-proxy-564f76e856b2" rel="external nofollow noopener" target="_blank">https://medium.com/globant/</a></figcaption></figure> <p>Untuk membuat Nginx bisa berjalan seabagai reverse proxy server di perlukan beberapa konfigurasi, file konfigurasi secara default terdapat di direktori berikut <strong>/etc/nginx/sites-available/default </strong>dapat menggunakan editor nano atau vi vim.</p> <p>Pada kali ini saya menggunakan editor nano seperti script berikut.</p> <blockquote>sudo nano /etc/nginx/sites-available/default</blockquote> <p>selanjutnya tambahkan file konfigurasi pada block location</p> <blockquote>location / {</blockquote> <blockquote> <strong>proxy_pass </strong><a href="http://localhost:8000;" rel="external nofollow noopener" target="_blank"><strong>http://localhost:8000;</strong></a> </blockquote> <blockquote><strong>proxy_http_version 1.1;</strong></blockquote> <blockquote><strong>proxy_set_header Upgrade $http_upgrade;</strong></blockquote> <blockquote><strong>proxy_set_header Connection ‘upgrade’;</strong></blockquote> <blockquote><strong>proxy_set_header Host $host;</strong></blockquote> <blockquote><strong>proxy_cache_bypass $http_upgrade;</strong></blockquote> <blockquote>}</blockquote> <p>ctrl X lalu Y dan enter untuk menyimpan konfigurasi yang telah di buat.</p> <p>lalu restart kembali nginx dengan printah berikut</p> <blockquote>sudo systemctl restart nginx</blockquote> <p>restart juga web server node js nya</p> <blockquote>npm run start</blockquote> <p>untuk memastikan apakah reverse proxy server nginx ke nodejs webserver copy kembali publik ip aws lalu paste di browser maka akan di direct ke webser aws bukan home welcome nginx lagi.</p> <p>selanjutny setelah revers procy server berhasil kita dapat menerapkan limit akses ke server kita menggunakan nginx.</p> <h3>Limit Access dengan NGINX</h3> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*zZAsEhVyKlJdoMW8.png"><figcaption><a href="https://www.nginx.com/blog/rate-limiting-nginx/" rel="external nofollow noopener" target="_blank">https://www.nginx.com/blog/rate-limiting-nginx/</a></figcaption></figure> <p>dengan menerapkan limit akses ke webserver akan dapat menghindari serangan dari pihak yang tidak bertanggung jawan seperti serangan DDoS, maka dari itu limit akses bisa kita gunakan untuk membatasi seberapa banyak request yang dapat di layani / masuk ke dalam webserver kita.</p> <p>Masih pada file yang sama yaitu <strong>/etc/nginx/sites-available/default </strong>lakukan beberapa tambahan script seperti berikut :</p> <p>tambahkan script ini sebelum di atas blok server</p> <blockquote>limit_req_zone $binary_remote_addr zone=one:10m rate=30r/m;</blockquote> <p>lalu pada blok location tambahkan juga script berikut di akhir</p> <blockquote>limit_req zone=one;</blockquote> <p>Script di atas akan membatasi akses ke webserver Nginx hanya 2 request setiap detik atau 30 request setiap menit.</p> <p>ctrl X lalu Y dan enter untuk menyimpan konfigurasi yang telah di buat, lakukan restart kembali pada Nginx.</p> <blockquote>sudo systemctl restart nginx</blockquote> <p>untuk memastikan konfigurasi berjalan dengan baik, lakukan reload beberapa kali pada ip publik instance AWS, maka webserver nginx akan merespon 2 request saja perdetiknya jika lebih dari itu akan menampilkan <strong>server temporari unavailable.</strong></p> <p>Kita telah berhasil menerapkan limit access pada web server Node.js melalui bantuan NGINX. Dengan begitu, web server Node.js Anda kini bisa terhindar dari serangan DDoS yang dilakukan secara massive.</p> <p>Refrence</p> <p><a href="https://ubuntu.com/tutorials/install-and-configure-apache#1-overview" rel="external nofollow noopener" target="_blank">https://ubuntu.com/tutorials/install-and-configure-apache#1-overview</a></p> <p><a href="https://www.tecmint.com/change-apache-port-in-linux/" rel="external nofollow noopener" target="_blank">https://www.tecmint.com/change-apache-port-in-linux/</a></p> <p><a href="https://www.dicoding.com/academies/387/tutorials/23178/submission-guidance" rel="external nofollow noopener" target="_blank">https://www.dicoding.com/</a></p> <p><a href="https://www.nginx.com/blog/rate-limiting-nginx/" rel="external nofollow noopener" target="_blank">https://www.nginx.com/</a></p> <p><img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=ca69f4424be4" width="1" height="1" alt=""></p> </body></html>